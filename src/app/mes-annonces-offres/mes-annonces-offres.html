<div class="container">
  <div class="header">
    <h1>ğŸ“‹ Mes Annonces et Offres</h1>
    <div class="user-info">
      ğŸ‘¤ {{ getUsername() }}
      <button class="logout-btn" (click)="logout()">ğŸšª DÃ©connexion</button>
    </div>
  </div>

  <div class="tabs">
    <button 
      class="tab-btn" 
      [class.active]="activeTab === 'annonces'"
      (click)="switchTab('annonces')">
      ğŸ“¢ Mes Annonces
    </button>
    <button 
      class="tab-btn" 
      [class.active]="activeTab === 'mes-offres'"
      (click)="switchTab('mes-offres')">
      ğŸ’¼ Mes Offres
    </button>
    <button 
      class="tab-btn" 
      [class.active]="activeTab === 'offres-recues'"
      (click)="switchTab('offres-recues')">
      ğŸ“¥ Offres ReÃ§ues
    </button>
  </div>

  <div class="error-message" *ngIf="error">
    {{ error }}
  </div>

  <div class="loading" *ngIf="loading">
    Chargement...
  </div>

  <!-- Mes Annonces Tab -->
  <div class="content" *ngIf="activeTab === 'annonces' && !loading">
    <div class="section-header">
      <h2>Mes Annonces ({{ mesAnnonces.length }})</h2>
      <a routerLink="/" class="btn-primary">â• CrÃ©er une annonce</a>
    </div>

    <div class="grid" *ngIf="mesAnnonces.length > 0">
      <div class="card" *ngFor="let annonce of mesAnnonces">
        <div class="card-image" *ngIf="annonce.photoProduit">
          <img [src]="annonce.photoProduit" [alt]="annonce.nomProduit" />
        </div>
        <div class="card-content">
          <h3>{{ annonce.nomProduit }}</h3>
          <p class="description">{{ annonce.description }}</p>
          <div class="meta">
            <span class="badge" [class.badge-success]="annonce.valide" [class.badge-warning]="!annonce.valide">
              {{ annonce.valide ? 'âœ… ValidÃ©e' : 'â³ En attente' }}
            </span>
            <span class="badge" [class.badge-info]="annonce.actif" [class.badge-secondary]="!annonce.actif">
              {{ annonce.actif ? 'Actif' : 'Inactif' }}
            </span>
          </div>
          <div class="details">
            <span>Type: {{ annonce.type }}</span>
            <span>Ã‰tat: {{ annonce.etat }}</span>
            <span *ngIf="annonce.valeurEstimee">Valeur: {{ annonce.valeurEstimee | number:'1.0-0' }} DT</span>
          </div>
          <div class="card-actions">
            <button class="btn-secondary" (click)="navigateToAnnonce(annonce.id)">
              ğŸ‘ï¸ Voir
            </button>
            <button class="btn-danger" (click)="deleteAnnonce(annonce.id)">
              ğŸ—‘ï¸ Supprimer
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="mesAnnonces.length === 0">
      <p>ğŸ“ Vous n'avez pas encore publiÃ© d'annonce.</p>
      <a routerLink="/" class="btn-primary">CrÃ©er votre premiÃ¨re annonce</a>
    </div>
  </div>

  <!-- Mes Offres Tab -->
  <div class="content" *ngIf="activeTab === 'mes-offres' && !loading">
    <div class="section-header">
      <h2>Mes Offres ({{ mesOffres.length }})</h2>
    </div>

    <div class="grid" *ngIf="mesOffres.length > 0">
      <div class="card" *ngFor="let offre of mesOffres">
        <div class="card-content">
          <h3>Offre sur: {{ offre.annonce?.nomProduit }}</h3>
          <p class="description" *ngIf="offre.message">{{ offre.message }}</p>
          <div class="meta">
            <span class="badge" [ngClass]="getStatutBadgeClass(offre.statut)">
              {{ getStatutLabel(offre.statut) }}
            </span>
          </div>
          <div class="details">
            <span>Annonce de: {{ offre.annonce?.user?.nomComplet || offre.annonce?.user?.username }}</span>
            <span>Date: {{ formatDate(offre.dateCreation) }}</span>
          </div>
          <div class="card-actions">
            <button class="btn-secondary" (click)="navigateToAnnonce(offre.annonce?.id || 0)">
              ğŸ‘ï¸ Voir l'annonce
            </button>
            <button 
              class="btn-danger" 
              (click)="deleteOffre(offre.id)"
              *ngIf="offre.statut === 'EN_ATTENTE'">
              ğŸ—‘ï¸ Supprimer
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="mesOffres.length === 0">
      <p>ğŸ’¼ Vous n'avez pas encore fait d'offre.</p>
      <a routerLink="/" class="btn-primary">Parcourir les annonces</a>
    </div>
  </div>

  <!-- Offres ReÃ§ues Tab -->
  <div class="content" *ngIf="activeTab === 'offres-recues' && !loading">
    <div class="section-header">
      <h2>Offres ReÃ§ues ({{ offresRecues.length }})</h2>
    </div>

    <div class="grid" *ngIf="offresRecues.length > 0">
      <div class="card" *ngFor="let offre of offresRecues">
        <div class="card-content">
          <h3>Offre sur: {{ offre.annonce?.nomProduit }}</h3>
          <p class="description" *ngIf="offre.message">{{ offre.message }}</p>
          <div class="meta">
            <span class="badge" [ngClass]="getStatutBadgeClass(offre.statut)">
              {{ getStatutLabel(offre.statut) }}
            </span>
          </div>
          <div class="details">
            <span>De: {{ offre.user?.nomComplet || offre.user?.username }}</span>
            <span>Date: {{ formatDate(offre.dateCreation) }}</span>
          </div>
          <div class="card-actions" *ngIf="offre.statut === 'EN_ATTENTE'">
            <button class="btn-success" (click)="accepterOffre(offre.id)">
              âœ… Accepter
            </button>
            <button class="btn-danger" (click)="refuserOffre(offre.id)">
              âŒ Refuser
            </button>
            <button class="btn-secondary" (click)="navigateToAnnonce(offre.annonce?.id || 0)">
              ğŸ‘ï¸ Voir l'annonce
            </button>
          </div>
          <div class="card-actions" *ngIf="offre.statut !== 'EN_ATTENTE'">
            <button class="btn-secondary" (click)="navigateToAnnonce(offre.annonce?.id || 0)">
              ğŸ‘ï¸ Voir l'annonce
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="offresRecues.length === 0">
      <p>ğŸ“¥ Aucune offre reÃ§ue pour le moment.</p>
    </div>
  </div>

  <div class="footer">
    <a routerLink="/" class="btn-link">â† Retour Ã  l'accueil</a>
  </div>
</div>

